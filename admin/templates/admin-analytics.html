{% extends "base-admin.html" %}

{% block title %}Analytics - Admin{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="dashboard-header">
        <div>
            <h1>Analytics & Statistics</h1>
            <p>Track engagement and performance metrics</p>
        </div>
    </div>

    <!-- Analytics Grid -->
<div class="analytics-grid">
    <!-- Top Services -->
    <div class="analytics-card">
        <div class="card-header">
            <h2><i class="fas fa-chart-bar"></i> Top Services</h2>
            <p class="subtitle">Most viewed services</p>
        </div>
        <div class="card-content">
            {% if top_services %}
            <div class="list-items">
                {% for service in top_services %}
                <div class="list-item">
                    <span class="item-name">{{ service.service_name or 'Unknown' }}</span>
                    <span class="item-count">{{ service.count }} views</span>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-data">No service views yet</p>
            {% endif %}
        </div>
    </div>

    <!-- Top Positions -->
    <div class="analytics-card">
        <div class="card-header">
            <h2><i class="fas fa-briefcase"></i> Popular Positions</h2>
            <p class="subtitle">Most applied positions</p>
        </div>
        <div class="card-content">
            {% if top_positions %}
            <div class="list-items">
                {% for position in top_positions %}
                <div class="list-item">
                    <span class="item-name">{{ position[0] or 'Unknown' }}</span>
                    <span class="item-count">{{ position[1] }} applications</span>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-data">No applications yet</p>
            {% endif %}
        </div>
    </div>

    <!-- Daily Contacts -->
    <div class="analytics-card full-width">
        <div class="card-header">
            <h2><i class="fas fa-envelope"></i> Daily Contact Submissions (Last 30 Days)</h2>
            <p class="subtitle">Contact requests over time</p>
        </div>
        <div class="card-content">
            {% if daily_contacts %}
            <div class="daily-list">
                {% for day in daily_contacts %}
                <div class="daily-item">
                    <span class="date">{{ day[0] }}</span>
                    <div class="bar-container">
                        <div class="bar" style="width: {% if day[1] %}{{ (day[1] / 50) * 100 }}%{% else %}5%{% endif %}"></div>
                    </div>
                    <span class="count">{{ day[1] }} contacts</span>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-data">No contact data available</p>
            {% endif %}
        </div>
    </div>
</div>
</div>
{% endblock %}
